2025-05-16 11:50:28,137 - agent - INFO - Google Search is available for web search capabilities
2025-05-16 11:50:29,500 - google.adk.models.registry - INFO - Updating LLM class for gemini-.* from <class 'google.adk.models.google_llm.Gemini'> to <class 'google.adk.models.google_llm.Gemini'>
2025-05-16 11:50:29,500 - google.adk.models.registry - INFO - Updating LLM class for projects\/.+\/locations\/.+\/endpoints\/.+ from <class 'google.adk.models.google_llm.Gemini'> to <class 'google.adk.models.google_llm.Gemini'>
2025-05-16 11:50:29,500 - google.adk.models.registry - INFO - Updating LLM class for projects\/.+\/locations\/.+\/publishers\/google\/models\/gemini.+ from <class 'google.adk.models.google_llm.Gemini'> to <class 'google.adk.models.google_llm.Gemini'>
2025-05-16 11:50:29,500 - google.adk.models.registry - INFO - Updating LLM class for gemini-.* from <class 'google.adk.models.google_llm.Gemini'> to <class 'google.adk.models.google_llm.Gemini'>
2025-05-16 11:50:29,500 - google.adk.models.registry - INFO - Updating LLM class for projects\/.+\/locations\/.+\/endpoints\/.+ from <class 'google.adk.models.google_llm.Gemini'> to <class 'google.adk.models.google_llm.Gemini'>
2025-05-16 11:50:29,500 - google.adk.models.registry - INFO - Updating LLM class for projects\/.+\/locations\/.+\/publishers\/google\/models\/gemini.+ from <class 'google.adk.models.google_llm.Gemini'> to <class 'google.adk.models.google_llm.Gemini'>
2025-05-16 11:50:29,642 - agent - INFO - ADK Mode: Using model gemini-2.0-flash
2025-05-16 11:50:29,644 - agent - INFO - Imported simple callbacks using direct imports
2025-05-16 11:50:29,644 - agent - INFO - Google Search is available for use in the ADK
2025-05-16 11:50:29,644 - agent - INFO - Imported root agent prompt using direct import
2025-05-16 11:50:29,644 - sub_agents.accommodation_agent - INFO - Accommodation agent created using simplified pattern
2025-05-16 11:50:29,644 - sub_agents - INFO - Successfully imported AccommodationAgent
2025-05-16 11:50:29,645 - sub_agents.activity_agent - INFO - Activity agent created using simplified pattern
2025-05-16 11:50:29,645 - sub_agents - INFO - Successfully imported ActivityAgent
2025-05-16 11:50:29,645 - sub_agents.restaurant_agent - INFO - Restaurant agent created using simplified pattern
2025-05-16 11:50:29,645 - sub_agents - INFO - Successfully imported RestaurantAgent
2025-05-16 11:50:29,645 - sub_agents.transportation_agent - INFO - Transportation agent created using simplified pattern
2025-05-16 11:50:29,645 - sub_agents - INFO - Successfully imported TransportationAgent
2025-05-16 11:50:29,646 - sub_agents.travel_planner_agent - INFO - Travel planner agent created using simplified pattern with YouTube insights integration
2025-05-16 11:50:29,646 - sub_agents - INFO - Successfully imported TravelPlannerAgent
2025-05-16 11:50:29,647 - root - INFO - Backend initialized in Vertex AI (ADK) mode
2025-05-16 11:50:29,647 - root - INFO - Using model: gemini-2.0-flash
2025-05-16 11:50:29,667 - backend.tools.youtube.youtube - INFO - YouTube API libraries successfully imported
2025-05-16 11:50:29,668 - tools.youtube.youtube - INFO - YouTube API libraries successfully imported
2025-05-16 11:50:29,668 - tools.youtube.youtube_insight - INFO - Successfully imported YouTube functions from tools.youtube.youtube
2025-05-16 11:50:29,668 - backend.tools.youtube.youtube_insight - INFO - Successfully imported YouTube functions from tools.youtube.youtube
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO - Successfully imported YouTube tools from backend.tools.youtube.youtube_insight
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO - YouTube insight agent created using simplified pattern
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO - YouTube Insight Agent module loaded
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO - YouTube API dependencies are available
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO - YouTube tools available and ready to use
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO - YouTube Configuration:
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO -   - YouTube API Key Set: True
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO -   - YouTube Tools Available: True
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO -   - Store State Tool Available: False
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO -   - Timeout Seconds: 30
2025-05-16 11:50:29,668 - sub_agents.youtube_insight_agent - INFO - Testing YouTube API key...
2025-05-16 11:50:29,669 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-16 11:50:30,199 - sub_agents.youtube_insight_agent - INFO - YouTube API key is valid and working correctly.
2025-05-16 11:50:30,199 - sub_agents - INFO - Successfully imported YouTubeInsightAgent
2025-05-16 11:50:30,199 - sub_agents - INFO - Imported 6 sub-agents successfully
2025-05-16 11:50:30,199 - agent - INFO - Imported sub-agents using direct import
2025-05-16 11:50:30,199 - agent - INFO - Added accommodation_agent to sub-agents list
2025-05-16 11:50:30,199 - agent - INFO - Added activity_agent to sub-agents list
2025-05-16 11:50:30,199 - agent - INFO - Added restaurant_agent to sub-agents list
2025-05-16 11:50:30,199 - agent - INFO - Added transportation_agent to sub-agents list
2025-05-16 11:50:30,199 - agent - INFO - Added travel_planner_agent to sub-agents list
2025-05-16 11:50:30,199 - agent - INFO - Added youtube_insight_agent to sub-agents list
2025-05-16 11:50:30,200 - agent - INFO - Root agent created with 1 tools (sub-agents disabled for Vertex AI compatibility)
2025-05-16 11:50:30,200 - __main__ - INFO - Starting direct sub-agent test
2025-05-16 11:50:30,200 - __main__ - INFO - Calling accommodation agent with query: หาที่พักราคาประหยัดในหัวหิน
2025-05-16 11:50:30,264 - agent - INFO - Extracted travel info: {'origin': 'กรุงเทพ', 'destination': 'ภายในประเทศไทย', 'start_date': 'ไม่ระบุ', 'end_date': 'ไม่ระบุ', 'budget': 'ไม่ระบุ', 'num_travelers': 1, 'preferences': [], 'duration': 'ไม่ระบุ'}
2025-05-16 11:50:30,264 - agent - INFO - 🔍 SUB-AGENT REQUEST: accommodation_agent
2025-05-16 11:50:30,264 - agent - INFO - 📄 accommodation_agent request: คุณคือผู้เชี่ยวชาญด้านที่พัก ให้คำแนะนำที่พักที่เหมาะสมกับความต้องการของผู้ใช้
คำขอ: 
            ฉันกำลังวางแผนเดินทางจาก กรุงเทพ ไป ภายในประเทศไทย
            ในวันที่ ไม่ระบุ ถึง ไม่ระบุ
            มีงบประมาณทั้งหมด ไม่ระบุ บาท

            ช่วยแนะนำที่พักที่เหมาะสมได้ไหม? ต้องการที่พักคุณภาพดี ราคาคุ้มค่า ทำเลสะดวก
            พร้อมราคาต่อคืนที่เหมาะกับงบประมาณ
        

โปรดให้คำแนะนำเกี่ยวกับ:
1. ประเภทที่พัก (โรงแรม, โฮสเทล, รีสอร์ท, เกสต์เฮาส์) ที่ ภายในประเทศไทย
2. ช่วงราคาโดยประมาณต่อ... [truncated]
2025-05-16 11:50:30,264 - agent - INFO - Calling sub-agent: accommodation
2025-05-16 11:50:35,668 - agent - INFO - ✅ SUB-AGENT RESPONSE: accommodation_agent
2025-05-16 11:50:35,668 - agent - INFO - 📄 accommodation_agent response: แน่นอนครับ! เพื่อให้ผมสามารถแนะนำที่พักที่เหมาะสมที่สุดสำหรับคุณได้ กรุณาให้ข้อมูลเพิ่มเติมดังนี้ครับ:

1.  **จุดหมายปลายทาง:** คุณต้องการเดินทางไปที่จังหวัด/เมืองใดในประเทศไทยครับ? (เช่น เชียงใหม่, ภูเก็ต, กระบี่, พัทยา, หัวหิน, ฯลฯ)
2.  **งบประมาณ:** แม้ว่าคุณจะไม่ได้ระบุงบประมาณทั้งหมด แต่ช่วยระบุช่วงราคาต่อคืนที่คุณต้องการได้ไหมครับ? (เช่น ไม่เกิน 1,000 บาท, 1,000-2,000 บาท, 2,000-3,000 บาท, 3,000 บาทขึ้นไป)
3.  **ลักษณะการเดินทาง:** คุณเดินทางคนเดียว, เป็นคู่, กับครอบครัว หรือกลุ่มเพื่อน? จ... [truncated]
2025-05-16 11:50:35,669 - agent - INFO - Sub-agent accommodation response generated
2025-05-16 11:50:35,669 - __main__ - INFO - ACCOMMODATION AGENT RESPONSE: แน่นอนครับ! เพื่อให้ผมสามารถแนะนำที่พักที่เหมาะสมที่สุดสำหรับคุณได้ กรุณาให้ข้อมูลเพิ่มเติมดังนี้ครั...
2025-05-16 11:50:35,669 - __main__ - INFO - Sub-agent accommodation call completed successfully
2025-05-16 11:50:35,669 - __main__ - INFO - Calling restaurant agent with query: ร้านอาหารอร่อยในหัวหิน
2025-05-16 11:50:35,670 - agent - INFO - Extracted travel info: {'origin': 'กรุงเทพ', 'destination': 'ภายในประเทศไทย', 'start_date': 'ไม่ระบุ', 'end_date': 'ไม่ระบุ', 'budget': 'ไม่ระบุ', 'num_travelers': 1, 'preferences': [], 'duration': 'ไม่ระบุ'}
2025-05-16 11:50:35,671 - agent - INFO - 🔍 SUB-AGENT REQUEST: restaurant_agent
2025-05-16 11:50:35,671 - agent - INFO - 📄 restaurant_agent request: คุณคือผู้เชี่ยวชาญด้านอาหารและร้านอาหาร ให้คำแนะนำร้านอาหารตามความต้องการของผู้ใช้
คำขอ: 
            ฉันกำลังวางแผนเดินทางไป ภายในประเทศไทย
            ในวันที่ ไม่ระบุ ถึง ไม่ระบุ
            มีงบประมาณทั้งหมด ไม่ระบุ บาท

            ช่วยแนะนำร้านอาหารอร่อยที่ ภายในประเทศไทย ได้ไหม?
            ต้องการทราบชื่อร้าน ประเภทอาหาร เมนูเด็ดที่ต้องลอง และราคาคร่าวๆ ต่อมื้อ
            อยากได้หลากหลายราคาทั้งแบบประหยัดและร้านดังๆ
        

โปรดให้คำแนะนำเกี่ยวกับร้านอาหารที่ ภายในประเทศไทย โดยครอบคลุ... [truncated]
2025-05-16 11:50:35,671 - agent - INFO - Calling sub-agent: restaurant
2025-05-16 11:50:44,781 - agent - INFO - ✅ SUB-AGENT RESPONSE: restaurant_agent
2025-05-16 11:50:44,781 - agent - INFO - 📄 restaurant_agent response: แน่นอนครับ! เนื่องจากคุณไม่ได้ระบุสถานที่ในประเทศไทยที่ต้องการไป ผมขอแนะนำร้านอาหารอร่อยใน **กรุงเทพมหานคร** ซึ่งเป็นเมืองที่มีความหลากหลายทางด้านอาหารมากที่สุดแห่งหนึ่งในประเทศไทยนะครับ

**1. อาหารท้องถิ่นที่ห้ามพลาดและร้านที่ขึ้นชื่อ:**

*   **ร้านเจ๊ไฝ (อาหารไทยสตรีทฟู้ด):** ร้านดังระดับมิชลินสตาร์ที่ต้องลองผัดขี้เมาทะเล, ไข่เจียวปู ราคาค่อนข้างสูง (800 - 1,500 บาทต่อจาน) ตั้งอยู่ในย่านประตูผี
*   **ร้านทิพย์สมัย ผัดไทยประตูผี:** ร้านผัดไทยชื่อดังที่เปิดมานาน รสชาติเข้มข้น มีผัดไทยหลากหลายแบบ... [truncated]
2025-05-16 11:50:44,781 - agent - INFO - Sub-agent restaurant response generated
2025-05-16 11:50:44,782 - __main__ - INFO - RESTAURANT AGENT RESPONSE: แน่นอนครับ! เนื่องจากคุณไม่ได้ระบุสถานที่ในประเทศไทยที่ต้องการไป ผมขอแนะนำร้านอาหารอร่อยใน **กรุงเทพ...
2025-05-16 11:50:44,782 - __main__ - INFO - Sub-agent restaurant call completed successfully
2025-05-16 11:50:44,782 - __main__ - INFO - Calling travel_planner agent with query: วางแผนท่องเที่ยวหัวหิน 3 วัน
2025-05-16 11:50:44,782 - agent - INFO - Extracted travel info: {'origin': 'กรุงเทพ', 'destination': 'ภายในประเทศไทย', 'start_date': 'ไม่ระบุ', 'end_date': 'ไม่ระบุ', 'budget': 'ไม่ระบุ', 'num_travelers': 1, 'preferences': [], 'duration': 'ไม่ระบุ'}
2025-05-16 11:50:44,782 - agent - INFO - 🔍 SUB-AGENT REQUEST: travel_planner_agent
2025-05-16 11:50:44,782 - agent - INFO - 📄 travel_planner_agent request: คุณคือผู้วางแผนการเดินทางผู้เชี่ยวชาญ สร้างแผนการเดินทางแบบครบวงจร
คำขอ: วางแผนท่องเที่ยวหัวหิน 3 วัน

หลังจากวิเคราะห์คำขอของผู้ใช้ โปรดสร้างแผนการเดินทางจาก กรุงเทพ ไป ภายในประเทศไทย
ในวันที่ ไม่ระบุ ถึง ไม่ระบุ โดยมีงบประมาณ ไม่ระบุ บาท

แผนการเดินทางต้องครอบคลุม:
1. การเดินทางไป-กลับ ระหว่าง กรุงเทพ และ ภายในประเทศไทย
   (เลือกวิธีที่ดีที่สุดทั้งด้านราคาและความสะดวก)
2. ที่พักตลอดการเดินทาง (เลือกที่พักที่เหมาะสมกับงบประมาณ แต่มีคุณภาพดี)
3. สถานที่ท่องเที่ยวและกิจกรรมในแต่ละวัน จัดเรียงตามค... [truncated]
2025-05-16 11:50:44,782 - agent - INFO - Calling sub-agent: travel_planner
2025-05-16 11:50:59,120 - agent - INFO - ✅ SUB-AGENT RESPONSE: travel_planner_agent
2025-05-16 11:50:59,120 - agent - INFO - 📄 travel_planner_agent response: เนื่องจากคุณไม่ได้ระบุ งบประมาณ วันที่เดินทาง และความชอบส่วนตัว ผมจะสร้างแผนการเดินทางท่องเที่ยวหัวหิน 3 วัน โดยอิงจากงบประมาณปานกลาง และเน้นกิจกรรมยอดนิยม พร้อมตัวเลือกที่พักและร้านอาหารที่หลากหลาย เพื่อให้คุณสามารถปรับเปลี่ยนได้ตามความต้องการ

**===== แผนการเดินทางของคุณ =====**

**ภาพรวม:**

*   **จุดหมาย:** หัวหิน, ประเทศไทย
*   **ระยะเวลา:** 3 วัน 2 คืน
*   **งบประมาณ:** (ปรับเปลี่ยนได้ตามความต้องการ) ผมจะแสดงตัวอย่างค่าใช้จ่ายโดยประมาณ เพื่อให้คุณปรับงบได้
*   **สไตล์การเดินทาง:** ผ่อนคลาย... [truncated]
2025-05-16 11:50:59,120 - agent - INFO - Sub-agent travel_planner response generated
2025-05-16 11:50:59,121 - __main__ - INFO - TRAVEL_PLANNER AGENT RESPONSE: เนื่องจากคุณไม่ได้ระบุ งบประมาณ วันที่เดินทาง และความชอบส่วนตัว ผมจะสร้างแผนการเดินทางท่องเที่ยวหัวห...
2025-05-16 11:50:59,121 - __main__ - INFO - Sub-agent travel_planner call completed successfully
2025-05-16 11:50:59,121 - __main__ - INFO - All direct sub-agent tests completed
